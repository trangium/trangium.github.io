<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <title>TORCS prototype</title>
    <style>
        * {
            padding: 0;
            margin: 0;
        }

        canvas {
            background: #eee;
            display: block;
            margin: 0 auto;
        }
    </style>
</head>

<body>

    <canvas id="myCanvas" width="480" height="320"></canvas>

    <script>
        var canvas = document.getElementById("myCanvas");
        var ctx = canvas.getContext("2d");
        ctx.font = "25px Century Gothic";
        // prod[ed] = a[b[ed] >> 1] ^ (b[ed] & 1); // If mid-operator is ^ you don't need the & 31 at the end but it improves performance for whatever reason
        var edgeMult = function(a, b, prod) { 
            for (let ed = 0; ed < 12; ed++) {
                prod[ed] = (a[b[ed] & 15] + (b[ed] & 16)) & 31
            }
        }
        var cornMult = function(a, b, prod) { // faster than the min2phase implementation
            for (let corn = 0; corn < 8; corn++) {
                let temp = (a[b[corn] & 7] + (b[corn] & 24)); 
                prod[corn] = temp<24 ? temp : temp-24;
            }
        }

        var uEdge = [3, 0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 11];
        var rEdge = [0, 4, 2, 3, 9, 5, 6, 1, 8, 7, 10, 11];
        var fEdge = [0, 1, 21, 3, 18, 24, 6, 7, 20, 9, 10, 11];
        var dEdge = [0, 1, 2, 3, 4, 5, 6, 7, 11, 8, 9, 10];
        var lEdge = [0, 1, 2, 6, 4, 3, 11, 7, 8, 9, 10, 5];
        var bEdge = [23, 1, 2, 3, 4, 5, 16, 26, 8, 9, 22, 11];
        var edgeMove = [uEdge, rEdge, fEdge, dEdge, lEdge, bEdge];

        var uCorn = [3, 0, 1, 2, 4, 5, 6, 7];
        var rCorn = [0, 10, 21, 3, 4, 14, 17, 7];
        var fCorn = [0, 1, 11, 20, 13, 18, 6, 7];
        var dCorn = [0, 1, 2, 3, 7, 4, 5, 6];
        var lCorn = [23, 1, 2, 8, 19, 5, 6, 12];
        var bCorn = [9, 22, 2, 3, 4, 5, 15, 16];
        var cornMove = [uCorn, rCorn, fCorn, dCorn, lCorn, bCorn];
        
        function doMoves(movelist) {
            let cubeEdge = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11];
            let cubeCorn = [0, 1, 2, 3, 4, 5, 6, 7];
            let edgeTemp = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11];
            let cornTemp = [0, 1, 2, 3, 4, 5, 6, 7];
            for (let i=0; i<movelist.length; i++) {
                edgeMult(cubeEdge, edgeMove[movelist[i]], edgeTemp);
                cornMult(cubeCorn, cornMove[movelist[i]], cornTemp);
                cubeEdge = edgeTemp.slice();
                cubeCorn = cornTemp.slice();
                console.log(cubeCorn);
            }
            return [cubeEdge, cubeCorn];
        }
        var prod = doMoves([0, 3, 1, 4, 2, 5, 0, 3, 1, 4, 2, 5]);
        ctx.fillText(prod[0],30,30);
        ctx.fillText(prod[1],30,130);
        let a=Date.now();
        for(let i=0;i<23456789;i++){
            edgeMult(uEdge, fEdge, prod);
        }
        ctx.fillText((Date.now()-a),30,190); 
    </script>

</body>

</html>