<!DOCTYPE html>
<html>

    <head>
        <meta charset="utf-8" />
        <title>Subsolver</title>
        <style>
            .button {
                border: none;
                color: white;
                padding: 16px 28px;
                text-align: center;
                text-decoration: none;
                display: inline-block;
                font-size: 16px;
                margin: 4px 2px;
                transition-duration: 0.4s;
                cursor: pointer;
            }
    
            .button1 {
                background-color: white;
                color: black;
                border: 2px solid #000000;
            }
    
            .button1:hover {
                background-color: #000000;
                color: white;
            }

            input[type=checkbox] {
                transform: scale(1.3);
            }

            th, td {
            text-align: left;
            padding: 0px;
            vertical-align: top;
            }

        </style>
    </head>
    
    <body>
        <div style="font-family:courier new;font-size:17px">
            <button style="font-family:courier new;font-size:17px" class="button button1"
                onclick="calc()" id="calc-button"><strong>Start Search</strong></button> 
            <button style="font-family:courier new;font-size:17px" class="button button1"
                onclick="clearOutput()"><strong>Clear Output</strong></button> 
            <button style="font-family:courier new;font-size:17px" class="button button1" id="optVisButton"
                onclick="optionVisibility()"><strong>Hide Options</strong></button><br>
                
            <strong><br>
                <div id="options">
                    <input id="showProgUpdates" type="checkbox" checked><label for="showProgUpdates"> Output progress updates</label><br><br>
                </div>

                <div id="input">
                    Puzzle<br>
                    <textarea id="puzzle" rows="15" cols="69" spellcheck="false">
U: (UF UL UB UR) (UFR UFL UBL UBR)
R: (UR BR DR FR) (UFR-1 UBR+1 DBR-1 DFR+1)
F: (UF+1 FR+1 DF+1 FL+1) (UFR+1 DFR-1 DFL+1 UFL-1)
D: (DF DR DB DL) (DFR DBR DBL DFL)
L: (UL FL DL BL) (UFL+1 DFL-1 DBL+1 UBL-1)
B: (UB+1 BL+1 DB+1 BR+1) (UBR-1 UBL+1 DBL-1 DBR+1)</textarea><br><br>
                    Unique Orientations & Equivalences<br>
                    <textarea id="ignore" rows="4" cols="69" spellcheck="false"></textarea><br><br>

                    <table>
                        <tr>
                            <th>Prune</th>
                            <th>Search</th>
                            <th>Subgroup</th>
                        </tr>
                        <tr>
                            <td><textarea id="prune" rows="1" cols="7" spellcheck="false"></textarea>&nbsp;&nbsp;</td>
                            <td><textarea id="search" rows="1" cols="7" spellcheck="false"></textarea>&nbsp;&nbsp;</td>
                            <td><textarea id="subgroup" rows="1" cols="41" spellcheck="false"></textarea></td>
                        </tr>
                    </table><br>

                    Scramble<br>
                    <textarea id="solve" rows="3" cols="69" spellcheck="false"></textarea><br><br>
                    Output<br>
                    <textarea id="output" rows="26" cols="69" spellcheck="false" readonly></textarea>
                </div>
            </strong>
        </div>

    <script>
        let w;

        function calc() {
            if (document.getElementById("calc-button").innerText == "Start Search") {
                document.getElementById("calc-button").innerHTML = "<strong>&nbsp;End Search&nbsp;</strong>";
                w = new Worker("worker.js");
                w.postMessage({
                    input: 
                        {puzzle: document.getElementById('puzzle').value, 
                        ignore: document.getElementById('ignore').value,
                        subgroup: document.getElementById('subgroup').value,
                        prune: document.getElementById('prune').value,
                        search: document.getElementById('search').value,
                        solve: document.getElementById('solve').value},
                    showProgUpdates: document.getElementById("showProgUpdates").checked}); // start computation

                w.onmessage = function(event) {
                    if (event.data === "::STOP::") {
                        stopSearch();
                    } else {
                        document.getElementById("output").value += event.data+"\n";
                    }
                }
            } else {
                stopSearch();
            }
        }

        function stopSearch() {
            w.terminate();
            document.getElementById("calc-button").innerHTML = "<strong>Start Search</strong>";
        }

        function optionVisibility() {
            let options = document.getElementById("options")
            let optVisButton = document.getElementById("optVisButton")
            if (options.hidden) {
                options.hidden = false;
                optVisButton.innerHTML = "<strong>Hide Options</strong>";
            } else {
                options.hidden = true;
                optVisButton.innerHTML = "<strong>Show Options</strong>";
            }
        }

        function clearOutput() {
            document.getElementById("output").value = "";
        }
        
</script>

</body>

</html>