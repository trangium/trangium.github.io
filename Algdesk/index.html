<!DOCTYPE html>
<html>

    <head>
        <meta charset="utf-8" />
        <title>Subsolver</title>
        <style>
            .button {
                border: none;
                color: white;
                padding: 16px 28px;
                text-align: center;
                text-decoration: none;
                display: inline-block;
                font-size: 16px;
                margin: 4px 2px;
                transition-duration: 0.4s;
                cursor: pointer;
            }
    
            .button1 {
                background-color: white;
                color: black;
                border: 2px solid #000000;
            }
    
            .button1:hover {
                background-color: #000000;
                color: white;
            }
            input[type=checkbox] {
                transform: scale(1.3);
            }
            th, td {
            padding: 7px;
            }
        </style>
    </head>
    
    <body>
        <div style="font-family:courier new;font-size:17px">
            <button style="font-family:courier new;font-size:17px" class="button button1"
                onclick="calc()" id="calc-button"><strong>Start Search</strong></button> 
            <button style="font-family:courier new;font-size:17px" class="button button1"
                onclick="clearOutput()"><strong>Clear Output</strong></button> 
            <button style="font-family:courier new;font-size:17px" class="button button1" id="optVisButton"
                onclick="optionVisibility()"><strong>Hide Options</strong></button><br>
                
            <strong id="options">
                <br>
                <input id="showProgUpdates" type="checkbox" checked><label for="showProgUpdates"> Output progress updates</label><br>
            </strong>
            <br>
            <table valign="top">
                <tr>
                    <th>
                        Input
                    </th>
                    <th>
                        <textarea id="true-input" rows="16" cols="69" spellcheck="false"></textarea>
                    </th>
                </tr>
                <tr>
                    <th>
                        Output
                    </th>
                    <th>
                        <textarea id="output" rows="26" cols="69" spellcheck="false" readonly></textarea>
                    </th>
                </tr>
            </table>
        </div>
    <script>
        let w;

        function calc() {
            if (document.getElementById("calc-button").innerText == "Start Search") {
                document.getElementById("calc-button").innerHTML = "<strong>&nbsp;End Search&nbsp;</strong>";
                w = new Worker("worker.js");
                w.postMessage({input: document.getElementById("true-input").value, showProgUpdates: document.getElementById("showProgUpdates").checked}); // start computation

                w.onmessage = function(event) {
                    if (event.data === "::STOP::") {
                        stopSearch();
                    } else {
                        document.getElementById("output").value += event.data+"\n";
                    }
                }
            } else {
                stopSearch();
            }
        }

        function stopSearch() {
            w.terminate();
            document.getElementById("calc-button").innerHTML = "<strong>Start Search</strong>";
        }

        function optionVisibility() {
            let options = document.getElementById("options")
            let optVisButton = document.getElementById("optVisButton")
            if (options.hidden) {
                options.hidden = false;
                optVisButton.innerHTML = "<strong>Hide Options</strong>";
            } else {
                options.hidden = true;
                optVisButton.innerHTML = "<strong>Show Options</strong>";
            }
        }

        function clearOutput() {
            document.getElementById("output").value = "";
        }
        
</script>


    </script>
</body>

</html>